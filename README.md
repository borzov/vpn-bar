# VPN Bar

Легкое и удобное меню-бар приложение для macOS, которое позволяет быстро управлять VPN-подключениями прямо из строки меню.

## Описание

VPN Bar — это нативное приложение для macOS, которое отображается в строке меню и предоставляет быстрый доступ к управлению VPN-подключениями. Приложение автоматически обнаруживает все настроенные VPN-подключения в системе и позволяет подключать или отключать их одним кликом.

## Скриншоты

<table>
<tr>
<td align="center">
<a href="Files/screen-1.png" target="_blank">
<img src="Files/screen-1.png" alt="Скриншот 1" width="300"/>
</a>
</td>
<td align="center">
<a href="Files/screen-2.png" target="_blank">
<img src="Files/screen-2.png" alt="Скриншот 2" width="300"/>
</a>
</td>
<td align="center">
<a href="Files/screen-3.png" target="_blank">
<img src="Files/screen-3.png" alt="Скриншот 3" width="300"/>
</a>
</td>
</tr>
</table>

*Нажмите на изображение для просмотра в полном размере*

## Основные возможности

- **Индикация статуса VPN** — иконка в строке меню показывает, есть ли активное VPN-подключение
  - Полупрозрачная серая иконка при отсутствии активного подключения
  - Цветная иконка со щитом при активном VPN-подключении
- **Быстрое переключение** — левый клик по иконке переключает активное VPN-подключение
- **Глобальные горячие клавиши** — настраиваемая комбинация клавиш для переключения VPN из любого приложения
- **Уведомления** — системные уведомления при подключении или отключении VPN
- **Удобное меню** — правый клик открывает меню со списком всех доступных VPN-подключений
- **Визуальная индикация** — каждый VPN в меню отображается с иконкой статуса (подключен/отключен)
- **Гибкие настройки** — настройка интервала обновления, уведомлений и отображения
- **Легковесность** — минимальное потребление ресурсов системы

## Установка

1. Скачайте последнюю версию приложения из [Releases](https://github.com/borzov/vpn-bar/releases)
2. Распакуйте архив `VPNBarApp.zip`
3. Перетащите `VPNBarApp.app` в папку `Программы` (Applications)
4. Запустите приложение из папки `Программы`

**Примечание:** Техническое имя приложения остается `VPNBarApp.app`, но в системе оно отображается как "VPN Bar".

**Примечание:** При первом запуске macOS может запросить разрешение на доступ к сетевому расширению. Разрешите доступ для корректной работы приложения.

**Примечание:** Если macOS показывает предупреждение о безопасности, откройте **Системные настройки** → **Конфиденциальность и безопасность** и нажмите **Открыть в любом случае** рядом с сообщением о приложении.

### Обход карантина macOS

Если приложение заблокировано системой безопасности macOS (Gatekeeper), выполните следующие действия:

1. Откройте **Терминал** (Terminal)
2. Выполните команду:
   ```bash
   xattr -cr /Applications/VPNBarApp.app
   ```
3. Если это не помогло, попробуйте:
   ```bash
   sudo xattr -rd com.apple.quarantine /Applications/VPNBarApp.app
   ```
4. После этого попробуйте запустить приложение снова

Альтернативный способ:
1. Откройте **Системные настройки** → **Конфиденциальность и безопасность**
2. Найдите сообщение о блокировке приложения
3. Нажмите **Открыть в любом случае**

## Использование

### Основные действия

- **Левый клик по иконке** — переключает активное VPN-подключение (или первое доступное, если нет активных)
- **Правый клик по иконке** — открывает меню со списком VPN-подключений
- **Клик по VPN в меню** — подключает или отключает выбранное VPN-подключение
- **Горячие клавиши** — настраиваемая комбинация клавиш для переключения VPN из любого приложения

### Настройки

Откройте меню и выберите "Настройки" для доступа к параметрам приложения:

#### Основные
- **Интервал обновления статуса** — настройте, как часто приложение будет проверять статус VPN-подключений (рекомендуется: 10-15 секунд)
- **Уведомления** — включите/выключите системные уведомления при подключении или отключении VPN
- **Отображение** — показывать имя подключения во всплывающей подсказке (tooltip) при наведении на иконку

#### Горячие клавиши
- **Переключение VPN** — установите глобальную горячую клавишу для быстрого переключения VPN-подключения

## Системные требования

- macOS 12.0 (Monterey) или новее
- Настроенные VPN-подключения в системе

## Автозагрузка

Для автоматического запуска приложения при входе в систему:

1. Откройте **Системные настройки**
2. Перейдите в **Пользователи и группы**
3. Выберите вкладку **Объекты входа**
4. Нажмите кнопку **+** и добавьте `VPNBarApp.app` (отображается как "VPN Bar")

## Разработка

Приложение разработано с использованием Swift и следует рекомендациям Apple по разработке нативных приложений для macOS.

### Сборка из исходников

```bash
swift build -c release
./Scripts/package_app.sh
```

### Создание релиза

Релизы создаются автоматически при создании тега в формате `v*` (например, `v0.2.0`):

```bash
# После завершения работы над версией
git tag v0.2.0
git push origin v0.2.0
```

GitHub Actions автоматически:
- Соберет приложение
- Создаст .app bundle
- Упакует в ZIP архив
- Создаст GitHub Release с прикрепленным архивом

Если есть файл `CHANGELOG.md`, описание релиза будет взято из него, иначе будет использовано сообщение последнего коммита.

---

## Changelog

### Version 0.2.0 (2025-11-17)

**Крупное обновление с новыми возможностями**

#### Добавлено
- Глобальные горячие клавиши — настраиваемая комбинация клавиш для переключения VPN из любого приложения
- Системные уведомления — уведомления при подключении или отключении VPN с указанием имени подключения
- Улучшенная визуальная индикация:
  - Полупрозрачная серая иконка при отсутствии активного подключения
  - Цветная иконка со щитом при активном VPN-подключении
- Настройки отображения — возможность показывать имя подключения во всплывающей подсказке
- Обновленный интерфейс настроек — современный дизайн с вкладками и улучшенной группировкой элементов

#### Исправлено
- Улучшена стабильность работы уведомлений
- Оптимизировано обновление tooltip при изменении настроек

#### Технические детали
- Использование Carbon API для регистрации глобальных горячих клавиш
- Реализация уведомлений через NSUserNotification API для совместимости с меню-бар приложениями
- Рефакторинг кода для улучшения поддерживаемости

### Version 0.1.2 (2025-11-17)

**Улучшения визуальной индикации**

#### Добавлено
- Полупрозрачная серая иконка при отсутствии активного VPN-подключения
- Цветная иконка со щитом при активном VPN-подключении

### Version 0.1.1 (2025-11-16)

**Добавлена поддержка локализаций**

#### Добавлено
- Поддержка русского и английского языков
- Автоматическое определение языка системы
- Все текстовые строки вынесены в файлы локализации
- Обновлен скрипт упаковки для включения локализованных ресурсов в .app bundle

#### Технические детали
- Использование стандартной системы локализации macOS (NSLocalizedString)
- Файлы локализации: `en.lproj/Localizable.strings` и `ru.lproj/Localizable.strings`
- Настроен `defaultLocalization: "en"` в Package.swift

### Version 0.1.0 (2025-11-16)

**Первая версия приложения**

#### Добавлено
- Отображение иконки в строке меню с индикацией статуса VPN-подключения
- Автоматическое обнаружение всех VPN-подключений в системе
- Меню со списком VPN-подключений с визуальной индикацией статуса
- Подключение и отключение VPN-подключений одним кликом
- Переключение VPN левым кликом по иконке в строке меню
- Окно настроек с возможностью изменения интервала обновления статуса
- Сохранение настроек между сеансами работы приложения
- Поддержка всех типов VPN-подключений, настроенных в системе macOS

#### Технические детали
- Использование NetworkExtension.framework для управления VPN-подключениями
- Оптимизированное обновление статуса подключений для минимального потребления ресурсов
- Нативное меню-бар приложение без иконки в Dock (LSUIElement)
- Современный UI с использованием NSStackView и Auto Layout
